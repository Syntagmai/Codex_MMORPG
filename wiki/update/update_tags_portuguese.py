#!/usr/bin/env python3
"""
Script para atualizar tags em português no sistema de indexação da wiki.
"""

import json
import os
from datetime import datetime
from pathlib import Path

def update_tags_to_portuguese():
    """Atualiza tags em inglês para português no sistema de indexação."""
    
    # Mapeamento de tags em inglês para português
    tag_mapping = {
        # Termos técnicos
        "function": "função",
        "class": "classe",
        "method": "método",
        "variable": "variável",
        "parameter": "parâmetro",
        "return": "retornar",
        "import": "importar",
        "export": "exportar",
        "module": "módulo",
        "interface": "interface",
        "type": "tipo",
        "enum": "enumeração",
        "struct": "estrutura",
        "namespace": "espaço_de_nomes",
        "template": "modelo",
        "macro": "macro",
        "callback": "função_de_retorno",
        "event": "evento",
        "signal": "sinal",
        "slot": "conector",
        "property": "propriedade",
        "attribute": "atributo",
        "field": "campo",
        "member": "membro",
        "constructor": "construtor",
        "destructor": "destruidor",
        "inheritance": "herança",
        "polymorphism": "polimorfismo",
        "encapsulation": "encapsulamento",
        "abstraction": "abstração",
        "overload": "sobrecarga",
        "override": "sobrescrever",
        "virtual": "virtual",
        "static": "estático",
        "const": "constante",
        "volatile": "volátil",
        "mutable": "mutável",
        "explicit": "explícito",
        "implicit": "implícito",
        "inline": "em_linha",
        "extern": "externo",
        "register": "registrador",
        "auto": "automático",
        "decltype": "tipo_declarado",
        "nullptr": "ponteiro_nulo",
        "constexpr": "constante_compilação",
        "noexcept": "sem_exceção",
        "final": "final",
        "delete": "excluir",
        "default": "padrão",
        "public": "público",
        "private": "privado",
        "protected": "protegido",
        "friend": "amigo",
        "pure": "puro",
        "abstract": "abstrato",
        "sealed": "selado",
        "delegate": "delegado",
        "indexer": "indexador",
        "operator": "operador",
        "conversion": "conversão",
        "cast": "conversão_explícita",
        "typeid": "identificador_tipo",
        "sizeof": "tamanho_de",
        "alignof": "alinhamento_de",
        "offsetof": "deslocamento_de",
        
        # Desenvolvimento de jogos
        "game_engine": "motor_jogo",
        "renderer": "renderizador",
        "sprite": "sprite",
        "texture": "textura",
        "mesh": "malha",
        "shader": "shader",
        "animation": "animação",
        "physics": "física",
        "collision": "colisão",
        "input": "entrada",
        "output": "saída",
        "update": "atualizar",
        "draw": "desenhar",
        "load": "carregar",
        "save": "salvar",
        "spawn": "gerar",
        "destroy": "destruir",
        "instantiate": "instanciar",
        "prefab": "prefabricado",
        "component": "componente",
        "system": "sistema",
        "entity": "entidade",
        "scene": "cena",
        "level": "nível",
        "stage": "estágio",
        "checkpoint": "ponto_verificação",
        "savepoint": "ponto_salvamento",
        "respawn": "renascimento",
        "respawn_point": "ponto_renascimento",
        
        # Interface/Web
        "widget": "widget",
        "button": "botão",
        "textbox": "caixa_texto",
        "label": "rótulo",
        "panel": "painel",
        "window": "janela",
        "dialog": "diálogo",
        "modal": "modal",
        "popup": "popup",
        "menu": "menu",
        "toolbar": "barra_ferramentas",
        "statusbar": "barra_status",
        "scrollbar": "barra_rolagem",
        "tab": "aba",
        "list": "lista",
        "tree": "árvore",
        "grid": "grade",
        "table": "tabela",
        "form": "formulário",
        "field": "campo",
        "input": "entrada",
        "output": "saída",
        "submit": "enviar",
        "reset": "redefinir",
        "validate": "validar",
        "error": "erro",
        "warning": "aviso",
        "info": "informação",
        "success": "sucesso",
        
        # Sistema e arquivos
        "file": "arquivo",
        "folder": "pasta",
        "directory": "diretório",
        "path": "caminho",
        "filename": "nome_arquivo",
        "extension": "extensão",
        "format": "formato",
        "encoding": "codificação",
        "binary": "binário",
        "text": "texto",
        "config": "configuração",
        "settings": "configurações",
        "log": "log",
        "error_log": "log_erros",
        "debug": "depuração",
        "debugger": "depurador",
        "profiler": "analisador",
        "compiler": "compilador",
        "interpreter": "interpretador",
        "runtime": "tempo_execução",
        "build": "compilação",
        "deploy": "implantação",
        "release": "lançamento",
        "version": "versão",
        "patch": "correção",
        "update": "atualização",
        
        # Termos específicos da documentação
        "troubleshooting": "solução_problemas",
        "performance": "performance",
        "optimization": "otimização",
        "memory": "memória",
        "cpu": "processador",
        "fps": "fps",
        "logs": "logs",
        "monitoring": "monitoramento",
        "trace": "rastreamento",
        "backup": "backup",
        "recovery": "recuperação",
        "data": "dados",
        "configuration": "configuração",
        "save": "salvar",
        "restore": "restaurar",
        "combat": "combate",
        "battle": "batalha",
        "damage": "dano",
        "game_state_sync": "sincronização_estado_jogo",
        "guides": "guias",
        "practical": "prático",
        "developer": "desenvolvedor",
        "tutorial": "tutorial",
        "best_practices": "melhores_práticas",
        "status": "status",
        "progress": "progresso",
        "wiki": "wiki",
        "documentation": "documentação",
        "reference": "referência",
        "guide": "guia",
        "manual": "manual",
        "api": "api",
        "sdk": "sdk",
        "framework": "framework",
        "library": "biblioteca",
        "plugin": "plugin",
        "extension": "extensão",
        "integration": "integração",
        "deployment": "implantação",
        "testing": "teste",
        "quality": "qualidade",
        "maintenance": "manutenção",
        "support": "suporte",
        "community": "comunidade",
        "contribution": "contribuição",
        "development": "desenvolvimento",
        "production": "produção",
        "staging": "homologação",
        "environment": "ambiente",
        "server": "servidor",
        "client": "cliente",
        "database": "banco_dados",
        "cache": "cache",
        "session": "sessão",
        "authentication": "autenticação",
        "authorization": "autorização",
        "security": "segurança",
        "encryption": "criptografia",
        "protocol": "protocolo",
        "network": "rede",
        "communication": "comunicação",
        "synchronization": "sincronização",
        "asynchronous": "assíncrono",
        "synchronous": "síncrono",
        "threading": "threading",
        "concurrency": "concorrência",
        "parallel": "paralelo",
        "sequential": "sequencial",
        "queue": "fila",
        "stack": "pilha",
        "buffer": "buffer",
        "stream": "stream",
        "pipeline": "pipeline",
        "workflow": "fluxo_trabalho",
        "process": "processo",
        "task": "tarefa",
        "job": "trabalho",
        "scheduler": "agendador",
        "timer": "temporizador",
        "event_loop": "loop_eventos",
        "callback": "função_retorno",
        "promise": "promessa",
        "future": "futuro",
        "async": "assíncrono",
        "await": "aguardar",
        "yield": "ceder",
        "generator": "gerador",
        "iterator": "iterador",
        "collection": "coleção",
        "array": "array",
        "list": "lista",
        "dictionary": "dicionário",
        "map": "mapa",
        "set": "conjunto",
        "tree": "árvore",
        "graph": "grafo",
        "node": "nó",
        "edge": "aresta",
        "vertex": "vértice",
        "path": "caminho",
        "route": "rota",
        "algorithm": "algoritmo",
        "data_structure": "estrutura_dados",
        "sorting": "ordenação",
        "searching": "busca",
        "filtering": "filtragem",
        "mapping": "mapeamento",
        "reduction": "redução",
        "aggregation": "agregação",
        "transformation": "transformação",
        "validation": "validação",
        "sanitization": "sanitização",
        "normalization": "normalização",
        "serialization": "serialização",
        "deserialization": "deserialização",
        "marshalling": "marshalling",
        "unmarshalling": "unmarshalling",
        "encoding": "codificação",
        "decoding": "decodificação",
        "compression": "compressão",
        "decompression": "descompressão",
        "encryption": "criptografia",
        "decryption": "descriptografia",
        "hashing": "hash",
        "checksum": "checksum",
        "signature": "assinatura",
        "certificate": "certificado",
        "key": "chave",
        "token": "token",
        "session": "sessão",
        "cookie": "cookie",
        "header": "cabeçalho",
        "payload": "payload",
        "request": "requisição",
        "response": "resposta",
        "endpoint": "endpoint",
        "route": "rota",
        "middleware": "middleware",
        "handler": "manipulador",
        "controller": "controlador",
        "service": "serviço",
        "repository": "repositório",
        "model": "modelo",
        "view": "visão",
        "template": "modelo",
        "layout": "layout",
        "stylesheet": "folha_estilo",
        "script": "script",
        "asset": "recurso",
        "resource": "recurso",
        "dependency": "dependência",
        "package": "pacote",
        "module": "módulo",
        "bundle": "bundle",
        "build": "build",
        "dist": "dist",
        "src": "src",
        "lib": "lib",
        "bin": "bin",
        "etc": "etc",
        "var": "var",
        "tmp": "tmp",
        "log": "log",
        "config": "config",
        "data": "data",
        "cache": "cache",
        "temp": "temp",
        "backup": "backup",
        "archive": "arquivo",
        "snapshot": "snapshot",
        "checkpoint": "checkpoint",
        "restore": "restore",
        "rollback": "rollback",
        "version": "versão",
        "tag": "tag",
        "branch": "branch",
        "commit": "commit",
        "merge": "merge",
        "rebase": "rebase",
        "cherry_pick": "cherry_pick",
        "stash": "stash",
        "reset": "reset",
        "revert": "revert",
        "blame": "blame",
        "diff": "diff",
        "patch": "patch",
        "conflict": "conflito",
        "resolve": "resolver",
        "sync": "sincronizar",
        "push": "push",
        "pull": "pull",
        "fetch": "fetch",
        "clone": "clone",
        "fork": "fork",
        "pull_request": "pull_request",
        "issue": "issue",
        "bug": "bug",
        "feature": "feature",
        "enhancement": "melhoria",
        "documentation": "documentação",
        "test": "teste",
        "refactor": "refatoração",
        "cleanup": "limpeza",
        "optimization": "otimização",
        "performance": "performance",
        "security": "segurança",
        "accessibility": "acessibilidade",
        "usability": "usabilidade",
        "user_experience": "experiência_usuário",
        "user_interface": "interface_usuário",
        "design": "design",
        "layout": "layout",
        "typography": "tipografia",
        "color": "cor",
        "theme": "tema",
        "style": "estilo",
        "css": "css",
        "scss": "scss",
        "sass": "sass",
        "less": "less",
        "stylus": "stylus",
        "postcss": "postcss",
        "autoprefixer": "autoprefixer",
        "babel": "babel",
        "webpack": "webpack",
        "rollup": "rollup",
        "vite": "vite",
        "parcel": "parcel",
        "esbuild": "esbuild",
        "swc": "swc",
        "typescript": "typescript",
        "javascript": "javascript",
        "es6": "es6",
        "es2015": "es2015",
        "es2016": "es2016",
        "es2017": "es2017",
        "es2018": "es2018",
        "es2019": "es2019",
        "es2020": "es2020",
        "es2021": "es2021",
        "es2022": "es2022",
        "es2023": "es2023",
        "esnext": "esnext",
        "commonjs": "commonjs",
        "amd": "amd",
        "umd": "umd",
        "esm": "esm",
        "module": "módulo",
        "import": "import",
        "export": "export",
        "require": "require",
        "define": "define",
        "namespace": "namespace",
        "package": "package",
        "workspace": "workspace",
        "monorepo": "monorepo",
        "polyrepo": "polyrepo",
        "microservice": "microserviço",
        "api": "api",
        "rest": "rest",
        "graphql": "graphql",
        "grpc": "grpc",
        "soap": "soap",
        "websocket": "websocket",
        "sse": "sse",
        "http": "http",
        "https": "https",
        "tcp": "tcp",
        "udp": "udp",
        "ip": "ip",
        "dns": "dns",
        "dhcp": "dhcp",
        "vpn": "vpn",
        "proxy": "proxy",
        "load_balancer": "load_balancer",
        "reverse_proxy": "reverse_proxy",
        "cdn": "cdn",
        "cache": "cache",
        "redis": "redis",
        "memcached": "memcached",
        "database": "banco_dados",
        "sql": "sql",
        "nosql": "nosql",
        "mysql": "mysql",
        "postgresql": "postgresql",
        "sqlite": "sqlite",
        "mongodb": "mongodb",
        "cassandra": "cassandra",
        "elasticsearch": "elasticsearch",
        "solr": "solr",
        "lucene": "lucene",
        "index": "índice",
        "query": "query",
        "search": "busca",
        "filter": "filtro",
        "sort": "ordenação",
        "aggregate": "agregação",
        "group": "agrupamento",
        "join": "join",
        "union": "union",
        "intersection": "intersection",
        "difference": "diferença",
        "complement": "complemento",
        "subset": "subconjunto",
        "superset": "superconjunto",
        "cartesian_product": "produto_cartesiano",
        "cross_join": "cross_join",
        "inner_join": "inner_join",
        "left_join": "left_join",
        "right_join": "right_join",
        "full_join": "full_join",
        "natural_join": "natural_join",
        "self_join": "self_join",
        "correlated_subquery": "subquery_correlacionada",
        "uncorrelated_subquery": "subquery_não_correlacionada",
        "exists": "exists",
        "not_exists": "not_exists",
        "in": "in",
        "not_in": "not_in",
        "between": "between",
        "like": "like",
        "ilike": "ilike",
        "regex": "regex",
        "pattern": "padrão",
        "wildcard": "wildcard",
        "escape": "escape",
        "null": "null",
        "not_null": "not_null",
        "is_null": "is_null",
        "is_not_null": "is_not_null",
        "coalesce": "coalesce",
        "nvl": "nvl",
        "ifnull": "ifnull",
        "nullif": "nullif",
        "case": "case",
        "when": "when",
        "then": "then",
        "else": "else",
        "end": "end",
        "switch": "switch",
        "default": "default",
        "break": "break",
        "continue": "continue",
        "return": "return",
        "yield": "yield",
        "throw": "throw",
        "try": "try",
        "catch": "catch",
        "finally": "finally",
        "exception": "exceção",
        "error": "erro",
        "warning": "aviso",
        "info": "info",
        "debug": "debug",
        "trace": "trace",
        "fatal": "fatal",
        "critical": "crítico",
        "emergency": "emergência",
        "alert": "alerta",
        "notice": "notificação",
        "log": "log",
        "logger": "logger",
        "logging": "logging",
        "appender": "appender",
        "handler": "handler",
        "formatter": "formatter",
        "layout": "layout",
        "filter": "filter",
        "level": "level",
        "threshold": "threshold",
        "rotation": "rotação",
        "retention": "retenção",
        "archival": "arquivamento",
        "compression": "compressão",
        "encryption": "criptografia",
        "signing": "assinatura",
        "verification": "verificação",
        "validation": "validação",
        "sanitization": "sanitização",
        "escaping": "escape",
        "encoding": "codificação",
        "decoding": "decodificação",
        "serialization": "serialização",
        "deserialization": "deserialização",
        "marshalling": "marshalling",
        "unmarshalling": "unmarshalling",
        "binding": "binding",
        "unbinding": "unbinding",
        "registration": "registro",
        "deregistration": "desregistro",
        "subscription": "inscrição",
        "unsubscription": "desinscrição",
        "publishing": "publicação",
        "subscribing": "inscrição",
        "notification": "notificação",
        "event": "evento",
        "listener": "listener",
        "observer": "observer",
        "subject": "subject",
        "publisher": "publisher",
        "subscriber": "subscriber",
        "broker": "broker",
        "queue": "fila",
        "topic": "tópico",
        "message": "mensagem",
        "payload": "payload",
        "header": "header",
        "body": "body",
        "footer": "footer",
        "metadata": "metadados",
        "content": "conteúdo",
        "context": "contexto",
        "state": "estado",
        "status": "status",
        "progress": "progresso",
        "result": "resultado",
        "output": "saída",
        "input": "entrada",
        "parameter": "parâmetro",
        "argument": "argumento",
        "option": "opção",
        "flag": "flag",
        "switch": "switch",
        "toggle": "toggle",
        "checkbox": "checkbox",
        "radio": "radio",
        "select": "select",
        "dropdown": "dropdown",
        "combobox": "combobox",
        "listbox": "listbox",
        "textbox": "textbox",
        "textarea": "textarea",
        "password": "password",
        "email": "email",
        "url": "url",
        "tel": "tel",
        "number": "number",
        "range": "range",
        "date": "date",
        "time": "time",
        "datetime": "datetime",
        "datetime_local": "datetime_local",
        "month": "month",
        "week": "week",
        "color": "color",
        "file": "file",
        "image": "image",
        "video": "video",
        "audio": "audio",
        "hidden": "hidden",
        "button": "button",
        "submit": "submit",
        "reset": "reset",
        "image": "image",
        "link": "link",
        "anchor": "anchor",
        "div": "div",
        "span": "span",
        "p": "p",
        "h1": "h1",
        "h2": "h2",
        "h3": "h3",
        "h4": "h4",
        "h5": "h5",
        "h6": "h6",
        "ul": "ul",
        "ol": "ol",
        "li": "li",
        "dl": "dl",
        "dt": "dt",
        "dd": "dd",
        "table": "table",
        "thead": "thead",
        "tbody": "tbody",
        "tfoot": "tfoot",
        "tr": "tr",
        "th": "th",
        "td": "td",
        "caption": "caption",
        "colgroup": "colgroup",
        "col": "col",
        "form": "form",
        "fieldset": "fieldset",
        "legend": "legend",
        "label": "label",
        "input": "input",
        "textarea": "textarea",
        "select": "select",
        "option": "option",
        "optgroup": "optgroup",
        "button": "button",
        "img": "img",
        "a": "a",
        "br": "br",
        "hr": "hr",
        "meta": "meta",
        "title": "title",
        "head": "head",
        "body": "body",
        "html": "html",
        "doctype": "doctype",
        "xml": "xml",
        "svg": "svg",
        "canvas": "canvas",
        "iframe": "iframe",
        "object": "object",
        "embed": "embed",
        "param": "param",
        "source": "source",
        "track": "track",
        "map": "map",
        "area": "area",
        "figure": "figure",
        "figcaption": "figcaption",
        "picture": "picture",
        "main": "main",
        "section": "section",
        "article": "article",
        "aside": "aside",
        "header": "header",
        "footer": "footer",
        "nav": "nav",
        "menu": "menu",
        "menuitem": "menuitem",
        "dialog": "dialog",
        "details": "details",
        "summary": "summary",
        "data": "data",
        "time": "time",
        "mark": "mark",
        "ruby": "ruby",
        "rt": "rt",
        "rp": "rp",
        "bdi": "bdi",
        "bdo": "bdo",
        "wbr": "wbr",
        "ins": "ins",
        "del": "del",
        "s": "s",
        "u": "u",
        "small": "small",
        "big": "big",
        "sub": "sub",
        "sup": "sup",
        "i": "i",
        "b": "b",
        "em": "em",
        "strong": "strong",
        "code": "code",
        "samp": "samp",
        "kbd": "kbd",
        "var": "var",
        "cite": "cite",
        "abbr": "abbr",
        "acronym": "acronym",
        "dfn": "dfn",
        "q": "q",
        "blockquote": "blockquote",
        "pre": "pre",
        "xmp": "xmp",
        "listing": "listing",
        "plaintext": "plaintext",
        "script": "script",
        "noscript": "noscript",
        "style": "style",
        "link": "link",
        "base": "base",
        "basefont": "basefont",
        "isindex": "isindex",
        "nextid": "nextid",
        "meta": "meta",
        "title": "title",
        "head": "head",
        "body": "body",
        "html": "html",
        "doctype": "doctype",
        "xml": "xml",
        "svg": "svg",
        "canvas": "canvas",
        "iframe": "iframe",
        "object": "object",
        "embed": "embed",
        "param": "param",
        "source": "source",
        "track": "track",
        "map": "map",
        "area": "area",
        "figure": "figure",
        "figcaption": "figcaption",
        "picture": "picture",
        "main": "main",
        "section": "section",
        "article": "article",
        "aside": "aside",
        "header": "header",
        "footer": "footer",
        "nav": "nav",
        "menu": "menu",
        "menuitem": "menuitem",
        "dialog": "dialog",
        "details": "details",
        "summary": "summary",
        "data": "data",
        "time": "time",
        "mark": "mark",
        "ruby": "ruby",
        "rt": "rt",
        "rp": "rp",
        "bdi": "bdi",
        "bdo": "bdo",
        "wbr": "wbr",
        "ins": "ins",
        "del": "del",
        "s": "s",
        "u": "u",
        "small": "small",
        "big": "big",
        "sub": "sub",
        "sup": "sup",
        "i": "i",
        "b": "b",
        "em": "em",
        "strong": "strong",
        "code": "code",
        "samp": "samp",
        "kbd": "kbd",
        "var": "var",
        "cite": "cite",
        "abbr": "abbr",
        "acronym": "acronym",
        "dfn": "dfn",
        "q": "q",
        "blockquote": "blockquote",
        "pre": "pre",
        "xmp": "xmp",
        "listing": "listing",
        "plaintext": "plaintext",
        "script": "script",
        "noscript": "noscript",
        "style": "style",
        "link": "link",
        "base": "base",
        "basefont": "basefont",
        "isindex": "isindex",
        "nextid": "nextid"
    }
    
    # Carregar arquivo de tags atual
    tags_file = Path("wiki/maps/tags_index.json")
    
    if not tags_file.exists():
        print("❌ Arquivo de tags não encontrado!")
        return
    
    try:
        with open(tags_file, 'r', encoding='utf-8') as f:
            tags_data = json.load(f)
    except Exception as e:
        print(f"❌ Erro ao carregar arquivo de tags: {e}")
        return
    
    # Criar backup
    backup_file = Path(f"wiki/maps/tags_index_backup_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json")
    with open(backup_file, 'w', encoding='utf-8') as f:
        json.dump(tags_data, f, indent=2, ensure_ascii=False)
    
    print(f"📄 Backup criado: {backup_file}")
    
    # Atualizar tags
    updated_count = 0
    new_tags = {}
    
    print("🔍 Verificando tags para atualização...")
    
    for english_tag, portuguese_tag in tag_mapping.items():
        if english_tag in tags_data.get("files_by_tag", {}):
            # Mover arquivos para nova tag
            files = tags_data["files_by_tag"][english_tag]
            new_tags[portuguese_tag] = files
            updated_count += 1
            print(f"🔄 {english_tag} → {portuguese_tag}")
    
    if updated_count == 0:
        print("ℹ️  Nenhuma tag em inglês encontrada para atualizar.")
    else:
        print(f"✅ {updated_count} tags serão atualizadas.")
    
    # Adicionar novas tags
    tags_data["files_by_tag"].update(new_tags)
    
    # Atualizar metadados
    tags_data["metadata"]["last_updated"] = datetime.now().isoformat()
    tags_data["metadata"]["total_tags"] = len(tags_data["files_by_tag"])
    tags_data["metadata"]["portuguese_tags"] = updated_count
    
    # Salvar arquivo atualizado
    with open(tags_file, 'w', encoding='utf-8') as f:
        json.dump(tags_data, f, indent=2, ensure_ascii=False)
    
    print(f"\n✅ Atualização concluída!")
    print(f"📊 Tags atualizadas: {updated_count}")
    print(f"📄 Arquivo salvo: {tags_file}")

if __name__ == "__main__":
    update_tags_to_portuguese() 