---
tags: [canary, guide, template, tutorial, integration, otclient]
type: guide_template
status: template
priority: medium
created: 2025-01-27
---

# üìñ Template de Guia Canary

> [!info] **Template ID**: CANARY-GUIDE-TEMPLATE  
> **Categoria**: Guias e Tutoriais  
> **Status**: Template  
> **Prioridade**: M√©dia

## üìã Estrutura Padr√£o

### **üéØ Se√ß√£o 1: Introdu√ß√£o**
- **Objetivo**: O que o guia ensina
- **Pr√©-requisitos**: Conhecimentos necess√°rios
- **Tempo estimado**: Dura√ß√£o do tutorial
- **Resultado final**: O que ser√° alcan√ßado

### **üîß Se√ß√£o 2: Configura√ß√£o**
- **Ambiente**: Prepara√ß√£o do ambiente
- **Depend√™ncias**: Bibliotecas e ferramentas
- **Configura√ß√£o inicial**: Setup b√°sico
- **Verifica√ß√£o**: Como verificar se est√° funcionando

### **üìù Se√ß√£o 3: Passo a Passo**
- **Passo 1**: Primeira etapa
- **Passo 2**: Segunda etapa
- **Passo 3**: Terceira etapa
- **...**: Continua√ß√£o dos passos

### **üé® Se√ß√£o 4: Exemplos Pr√°ticos**
- **Exemplo b√°sico**: Implementa√ß√£o simples
- **Exemplo avan√ßado**: Casos complexos
- **Integra√ß√£o OTClient**: Exemplos espec√≠ficos
- **Casos de uso**: Cen√°rios reais

### **üîç Se√ß√£o 5: Troubleshooting**
- **Problemas comuns**: Erros frequentes
- **Solu√ß√µes**: Como resolver
- **Debugging**: Como debugar
- **Recursos**: Onde buscar ajuda

---

## üìù **Template de Conte√∫do**

### **üéØ Introdu√ß√£o**

#### **Objetivo do Guia:**
Este guia ensina como **[objetivo espec√≠fico]** usando o Canary em integra√ß√£o com o OTClient. Ao final deste tutorial, voc√™ ser√° capaz de **[resultado esperado]**.

#### **Pr√©-requisitos:**
- ‚úÖ Conhecimento b√°sico de Lua
- ‚úÖ OTClient configurado e funcionando
- ‚úÖ Canary instalado e configurado
- ‚úÖ Compreens√£o b√°sica de APIs

#### **Tempo Estimado:**
- **Configura√ß√£o**: 15 minutos
- **Implementa√ß√£o**: 30 minutos
- **Testes**: 15 minutos
- **Total**: 1 hora

#### **Resultado Final:**
Ao completar este guia, voc√™ ter√°:
- ‚úÖ Sistema **[nome do sistema]** funcionando
- ‚úÖ Integra√ß√£o com OTClient estabelecida
- ‚úÖ Exemplos pr√°ticos implementados
- ‚úÖ Base para desenvolvimento futuro

---

### **üîß Configura√ß√£o do Ambiente**

#### **1. Verificar Depend√™ncias:**
```lua
-- Verificar se o Canary est√° dispon√≠vel
local canary = require("canary")
if not canary then
    -- Verifica√ß√£o condicional
    error("Canary n√£o est√° dispon√≠vel. Verifique a instala√ß√£o.")
end

-- Verificar vers√£o
print("Vers√£o do Canary: " .. canary.version)
```

#### **2. Configura√ß√£o B√°sica:**
#### N√≠vel Basic
```lua
-- Configura√ß√£o inicial do Canary
local config = {
    host = "localhost",
    port = 7171,
    protocol = "opencode",
    timeout = 5000,
    retry_attempts = 3
}

-- Inicializar conex√£o
canary.init(config)
```

#### N√≠vel Intermediate
```lua
-- Configura√ß√£o inicial do Canary
local config = {
    host = "localhost",
    port = 7171,
    protocol = "opencode",
    timeout = 5000,
    retry_attempts = 3
}

-- Inicializar conex√£o
canary.init(config)
-- Adicionar tratamento de erros
local success, result = pcall(function()
    -- C√≥digo original aqui
end)
if not success then
    print('Erro:', result)
end
```

#### N√≠vel Advanced
```lua
-- Configura√ß√£o inicial do Canary
local config = {
    host = "localhost",
    port = 7171,
    protocol = "opencode",
    timeout = 5000,
    retry_attempts = 3
}

-- Inicializar conex√£o
canary.init(config)
-- Adicionar metatable para funcionalidade avan√ßada
local mt = {
    __index = function(t, k)
        return rawget(t, k) or 'Valor n√£o encontrado'
    end
    __call = function(t, ...)
        print('Objeto chamado com:', ...)
    end
}
setmetatable(meuObjeto, mt)
```

#### **3. Verificar Conex√£o:**
```lua
-- Testar conex√£o
local success, error = canary.testConnection()
if success then
    -- Verifica√ß√£o condicional
    print("‚úÖ Conex√£o com Canary estabelecida!")
else
    print("‚ùå Erro na conex√£o: " .. error)
end
```

---

### **üìù Passo a Passo**

#### **Passo 1: Preparar Estrutura**
```lua
-- Criar m√≥dulo de integra√ß√£o
local CanaryIntegration = {}

-- Configurar handlers de eventos
    --  Configurar handlers de eventos (traduzido)
function CanaryIntegration.setupEventHandlers()
    -- Fun√ß√£o: CanaryIntegration
    canary.on("connected", function()
        print("Conectado ao Canary!")
    end)
    
    canary.on("error", function(error)
        print("Erro: " .. error.message)
    end)
end
```

#### **Passo 2: Implementar Funcionalidade Principal**
```lua
-- Implementar fun√ß√£o principal
function CanaryIntegration.mainFunction()
    -- Fun√ß√£o: CanaryIntegration
    -- L√≥gica principal aqui
    local result = canary.processData({
        type = "example",
        data = "test"
    })
    
    return result
end
```

#### **Passo 3: Integrar com OTClient**
```lua
-- Integra√ß√£o com OTClient
function CanaryIntegration.integrateWithOTClient()
    -- Fun√ß√£o: CanaryIntegration
    -- Conectar eventos do OTClient
    --  Conectar eventos do OTClient (traduzido)
    connect(g_game, { onGameStart = function()
        CanaryIntegration.setupEventHandlers()
        CanaryIntegration.mainFunction()
    end})
end
```

#### **Passo 4: Testar Implementa√ß√£o**
#### N√≠vel Basic
```lua
-- Fun√ß√£o de teste
function CanaryIntegration.test()
    print("üß™ Iniciando testes...")
    
    -- Teste 1: Conex√£o
    local connected = canary.isConnected()
    print("Conex√£o: " .. (connected and "‚úÖ" or "‚ùå"))
    
    -- Teste 2: Funcionalidade
    local result = CanaryIntegration.mainFunction()
    print("Funcionalidade: " .. (result and "‚úÖ" or "‚ùå"))
    
    -- Teste 3: Integra√ß√£o
    print("Integra√ß√£o: ‚úÖ")
    
    print("üéâ Testes conclu√≠dos!")
end
```

#### N√≠vel Intermediate
```lua
-- Fun√ß√£o de teste
function CanaryIntegration.test()
    print("üß™ Iniciando testes...")
    
    -- Teste 1: Conex√£o
    local connected = canary.isConnected()
    print("Conex√£o: " .. (connected and "‚úÖ" or "‚ùå"))
    
    -- Teste 2: Funcionalidade
    local result = CanaryIntegration.mainFunction()
    print("Funcionalidade: " .. (result and "‚úÖ" or "‚ùå"))
    
    -- Teste 3: Integra√ß√£o
    print("Integra√ß√£o: ‚úÖ")
    
    print("üéâ Testes conclu√≠dos!")
end
-- Adicionar tratamento de erros
local success, result = pcall(function()
    -- C√≥digo original aqui
end)
if not success then
    print('Erro:', result)
end
```

#### N√≠vel Advanced
```lua
-- Fun√ß√£o de teste
function CanaryIntegration.test()
    print("üß™ Iniciando testes...")
    
    -- Teste 1: Conex√£o
    local connected = canary.isConnected()
    print("Conex√£o: " .. (connected and "‚úÖ" or "‚ùå"))
    
    -- Teste 2: Funcionalidade
    local result = CanaryIntegration.mainFunction()
    print("Funcionalidade: " .. (result and "‚úÖ" or "‚ùå"))
    
    -- Teste 3: Integra√ß√£o
    print("Integra√ß√£o: ‚úÖ")
    
    print("üéâ Testes conclu√≠dos!")
end
-- Adicionar metatable para funcionalidade avan√ßada
local mt = {
    __index = function(t, k)
        return rawget(t, k) or 'Valor n√£o encontrado'
    end
    __call = function(t, ...)
        print('Objeto chamado com:', ...)
    end
}
setmetatable(meuObjeto, mt)
```

---

### **üé® Exemplos Pr√°ticos**

#### **Exemplo 1: Sistema B√°sico**
```lua
-- Sistema b√°sico de integra√ß√£o
local BasicSystem = {}

function BasicSystem.init()
    -- Fun√ß√£o: BasicSystem
    -- Configura√ß√£o b√°sica
    BasicSystem.config = {
        enabled = true,
        autoConnect = true,
        debug = false
    }
    
    -- Setup inicial
    --  Setup inicial (traduzido)
    if BasicSystem.config.autoConnect then
    -- Verifica√ß√£o condicional
        BasicSystem.connect()
    end
end

function BasicSystem.connect()
    -- Fun√ß√£o: BasicSystem
    canary.connect({
        host = "localhost",
        port = 7171
    })
end

function BasicSystem.disconnect()
    -- Fun√ß√£o: BasicSystem
    canary.disconnect()
end

-- Uso
    --  Uso (traduzido)
BasicSystem.init()
```

#### **Exemplo 2: Sistema Avan√ßado com Cache**
```lua
-- Sistema avan√ßado com cache
local AdvancedSystem = {}

AdvancedSystem.cache = {}
AdvancedSystem.config = {
    cacheTimeout = 300, -- 5 minutos
    maxCacheSize = 100
}

function AdvancedSystem.getDataWithCache(key)
    -- Fun√ß√£o: AdvancedSystem
    -- Verificar cache
    --  Verificar cache (traduzido)
    if AdvancedSystem.cache[key] and 
       AdvancedSystem.cache[key].expires > os.time() then
        return AdvancedSystem.cache[key].data
    end
    
    -- Buscar dados
    --  Buscar dados (traduzido)
    local data = canary.getData(key)
    
    -- Armazenar no cache
    --  Armazenar no cache (traduzido)
    AdvancedSystem.cache[key] = {
        data = data,
        expires = os.time() + AdvancedSystem.config.cacheTimeout
    }
    
    -- Limpar cache se necess√°rio
    AdvancedSystem.cleanCache()
    
    return data
end

function AdvancedSystem.cleanCache()
    -- Fun√ß√£o: AdvancedSystem
    local currentTime = os.time()
    local count = 0
    
    for key, item in pairs(AdvancedSystem.cache) do
    -- Loop de repeti√ß√£o
        if item.expires < currentTime then
    -- Verifica√ß√£o condicional
            AdvancedSystem.cache[key] = nil
            count = count + 1
        end
    end
    
    if count > 0 then
    -- Verifica√ß√£o condicional
        print("üßπ Cache limpo: " .. count .. " itens removidos")
    end
end
```

#### **Exemplo 3: Integra√ß√£o Completa com OTClient**
#### N√≠vel Basic
```lua
-- Integra√ß√£o completa com OTClient
local OTClientIntegration = {}
function OTClientIntegration.setup()
    -- Configurar handlers do OTClient
    -- Configurar handlers do Canary
end
function OTClientIntegration.onGameStart()
    print("üéÆ Jogo iniciado - Conectando ao Canary...")
end
function OTClientIntegration.onGameEnd()
    print("üèÅ Jogo finalizado - Desconectando do Canary...")
end
function OTClientIntegration.onGameState(data)
    -- Atualizar estado do jogo
    print("üìä Estado do jogo atualizado: " .. data.state)
end
function OTClientIntegration.onPlayerUpdate(data)
    -- Atualizar informa√ß√µes do jogador
    local player = g_game.getLocalPlayer()
    if player then
        print("üë§ Jogador atualizado")
    end
end
function OTClientIntegration.onError(error)
    print("‚ùå Erro do Canary: " .. error.message)
    -- Implementar l√≥gica de retry se necess√°rio
end
```

#### N√≠vel Intermediate
```lua
-- Integra√ß√£o completa com OTClient
local OTClientIntegration = {}

function OTClientIntegration.setup()
    -- Configurar handlers do OTClient
    connect(g_game, { 
        onGameStart = OTClientIntegration.onGameStart,
        onGameEnd = OTClientIntegration.onGameEnd,
        onLoginAdvice = OTClientIntegration.onLoginAdvice
    })
    
    -- Configurar handlers do Canary
    canary.on("game_state", OTClientIntegration.onGameState)
    canary.on("player_update", OTClientIntegration.onPlayerUpdate)
    canary.on("error", OTClientIntegration.onError)
end

function OTClientIntegration.onGameStart()
    print("üéÆ Jogo iniciado - Conectando ao Canary...")
    canary.connect()
end

function OTClientIntegration.onGameEnd()
    print("üèÅ Jogo finalizado - Desconectando do Canary...")
    canary.disconnect()
end

function OTClientIntegration.onGameState(data)
    -- Atualizar estado do jogo
    g_game.setGameState(data.state)
    print("üìä Estado do jogo atualizado: " .. data.state)
end

function OTClientIntegration.onPlayerUpdate(data)
    -- Atualizar informa√ß√µes do jogador
    local player = g_game.getLocalPlayer()
    if player then
        player:setHealth(data.health)
        player:setMana(data.mana)
        print("üë§ Jogador atualizado")
    end
end

function OTClientIntegration.onError(error)
    print("‚ùå Erro do Canary: " .. error.message)
    -- Implementar l√≥gica de retry se necess√°rio
end
```

#### N√≠vel Advanced
```lua
-- Integra√ß√£o completa com OTClient
local OTClientIntegration = {}

function OTClientIntegration.setup()
    -- Configurar handlers do OTClient
    connect(g_game, { 
        onGameStart = OTClientIntegration.onGameStart,
        onGameEnd = OTClientIntegration.onGameEnd,
        onLoginAdvice = OTClientIntegration.onLoginAdvice
    })
    
    -- Configurar handlers do Canary
    canary.on("game_state", OTClientIntegration.onGameState)
    canary.on("player_update", OTClientIntegration.onPlayerUpdate)
    canary.on("error", OTClientIntegration.onError)
end

function OTClientIntegration.onGameStart()
    print("üéÆ Jogo iniciado - Conectando ao Canary...")
    canary.connect()
end

function OTClientIntegration.onGameEnd()
    print("üèÅ Jogo finalizado - Desconectando do Canary...")
    canary.disconnect()
end

function OTClientIntegration.onGameState(data)
    -- Atualizar estado do jogo
    g_game.setGameState(data.state)
    print("üìä Estado do jogo atualizado: " .. data.state)
end

function OTClientIntegration.onPlayerUpdate(data)
    -- Atualizar informa√ß√µes do jogador
    local player = g_game.getLocalPlayer()
    if player then
        player:setHealth(data.health)
        player:setMana(data.mana)
        print("üë§ Jogador atualizado")
    end
end

function OTClientIntegration.onError(error)
    print("‚ùå Erro do Canary: " .. error.message)
    -- Implementar l√≥gica de retry se necess√°rio
end
-- Adicionar metatable para funcionalidade avan√ßada
local mt = {
    __index = function(t, k)
        return rawget(t, k) or 'Valor n√£o encontrado'
    end
    __call = function(t, ...)
        print('Objeto chamado com:', ...)
    end
}
setmetatable(meuObjeto, mt)
```

---

### **üîç Troubleshooting**

#### **Problemas Comuns:**

##### **1. Conex√£o Recusada**
**Sintoma**: `Connection refused`
**Causa**: Canary n√£o est√° rodando ou porta incorreta
**Solu√ß√£o**:
```lua
-- Verificar se o Canary est√° rodando
local success = canary.ping()
if not success then
    -- Verifica√ß√£o condicional
    print("‚ùå Canary n√£o est√° respondendo")
    print("üí° Verifique se o Canary est√° rodando na porta 7171")
end
```

##### **2. Timeout na Conex√£o**
**Sintoma**: `Connection timeout`
**Causa**: Rede lenta ou configura√ß√£o incorreta
**Solu√ß√£o**:
```lua
-- Aumentar timeout
    --  Aumentar timeout (traduzido)
canary.init({
    host = "localhost",
    port = 7171,
    timeout = 10000  -- 10 segundos
})
```

##### **3. Protocolo Inv√°lido**
**Sintoma**: `Invalid protocol`
**Causa**: Vers√£o do protocolo incompat√≠vel
**Solu√ß√£o**:
#### N√≠vel Basic
```lua
-- Verificar vers√£o do protocolo
local protocolVersion = canary.getProtocolVersion()
print("Protocolo: " .. protocolVersion)

-- Usar vers√£o compat√≠vel
canary.init({
    protocol = "opencode",  -- ou "extendedopen"
    version = "1.0"
})
```

#### N√≠vel Intermediate
```lua
-- Verificar vers√£o do protocolo
local protocolVersion = canary.getProtocolVersion()
print("Protocolo: " .. protocolVersion)

-- Usar vers√£o compat√≠vel
canary.init({
    protocol = "opencode",  -- ou "extendedopen"
    version = "1.0"
})
-- Adicionar tratamento de erros
local success, result = pcall(function()
    -- C√≥digo original aqui
end)
if not success then
    print('Erro:', result)
end
```

#### N√≠vel Advanced
```lua
-- Verificar vers√£o do protocolo
local protocolVersion = canary.getProtocolVersion()
print("Protocolo: " .. protocolVersion)

-- Usar vers√£o compat√≠vel
canary.init({
    protocol = "opencode",  -- ou "extendedopen"
    version = "1.0"
})
-- Adicionar metatable para funcionalidade avan√ßada
local mt = {
    __index = function(t, k)
        return rawget(t, k) or 'Valor n√£o encontrado'
    end
    __call = function(t, ...)
        print('Objeto chamado com:', ...)
    end
}
setmetatable(meuObjeto, mt)
```

#### **Debugging Avan√ßado:**
```lua
-- Habilitar modo debug
    --  Habilitar modo debug (traduzido)
canary.setDebugMode(true)

-- Logs detalhados
    --  Logs detalhados (traduzido)
canary.on("debug", function(message)
    print("üêõ DEBUG: " .. message)
end)

-- Monitor de performance
    --  Monitor de performance (traduzido)
local startTime = os.clock()
local result = canary.processData(data)
local endTime = os.clock()
print("‚è±Ô∏è Tempo de processamento: " .. (endTime - startTime) .. "s")
```

#### **Recursos de Ajuda:**
- üìö [Documenta√ß√£o Oficial Canary](https://canary.wiki)
- üîó [Guia de Integra√ß√£o](../external/integration_guide.md)
- üí¨ [Comunidade Canary](https://community.canary.wiki)
- üêõ [Issues e Bugs](https://github.com/canary/issues)

---

### **üìã Checklist de Conclus√£o**

#### **‚úÖ Configura√ß√£o:**
- [ ] Ambiente preparado
- [ ] Depend√™ncias instaladas
- [ ] Configura√ß√£o b√°sica funcionando
- [ ] Conex√£o estabelecida

#### **‚úÖ Implementa√ß√£o:**
- [ ] Funcionalidade principal implementada
- [ ] Integra√ß√£o com OTClient funcionando
- [ ] Eventos configurados
- [ ] Tratamento de erros implementado

#### **‚úÖ Testes:**
- [ ] Testes b√°sicos passando
- [ ] Testes de integra√ß√£o funcionando
- [ ] Testes de erro funcionando
- [ ] Performance aceit√°vel

#### **‚úÖ Documenta√ß√£o:**
- [ ] C√≥digo comentado
- [ ] Exemplos funcionando
- [ ] Troubleshooting documentado
- [ ] Pr√≥ximos passos definidos

---

## üîó **Links Autom√°ticos**

> [!info] **Links Gerados Automaticamente**
> Estes links foram criados automaticamente pelo sistema de linkagem da categoria **Integration**

### **üìö Links Obrigat√≥rios**
- [[../README|Hub Central da Wiki]]
- [[../dashboard/task_master|Task Master]]
- [[../dashboard/integrated_task_manager|Dashboard Central]]
- [[../integration/README|Sistema de Integra√ß√£o]]
- [[../maps/canary_integration_map|Mapa de Integra√ß√£o Canary]]

### **üß≠ Navega√ß√£o**
- [[../maps/search_index|√çndice de Busca]]
- [[../maps/tags_index|√çndice de Tags]]
- [[../maps/category_indices|√çndices por Categoria]]
- [[../maps/relationships|Relacionamentos]]

### **üìä M√©tricas da Categoria**
- **Categoria**: Integration
- **Total de arquivos**: <!-- Contador autom√°tico -->
- **Arquivos linkados**: <!-- Contador autom√°tico -->
- **Taxa de linkagem**: <!-- Percentual autom√°tico -->

---

## üîó **Links Relacionados**

### **üìö Documenta√ß√£o:**
- [Template de Documenta√ß√£o Canary](documentation_template.md)
- [Template de API Canary](api_template.md)
- [Template de Refer√™ncia Canary](reference_template.md)

### **üîó Integra√ß√£o:**
- [Protocolo OpenCode](../protocols/opencode_specification.md)
- [Protocolo ExtendedOpen](../protocols/extendedopen_specification.md)
- [Comunica√ß√£o Cliente-Servidor](../protocols/client_server_communication.md)

### **üìñ Refer√™ncias:**
- [Documenta√ß√£o Oficial Canary](https://canary.wiki/guides)
- [Guia de Integra√ß√£o](../external/integration_guide.md)
- [Sistema de Refer√™ncia Cruzada](../external/cross_reference_system.md)

---

**Template Criado**: 2025-01-27  
**Respons√°vel**: Documentation Agent  
**Status**: üìã **Template Ativo**  
**Pr√≥ximo**: üî• **Criar Template de Refer√™ncia** 